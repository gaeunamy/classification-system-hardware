# YOLOv5를 이용한 과일 분류 시스템

## 📝 프로젝트 설명  
이 프로젝트는 YOLOv5 딥러닝 모델을 활용하여 정상과 불량 과일을 자동으로 분류하는 시스템을 개발한 것입니다. OpenCV와 PyTorch를 이용하여 이미지 및 영상을 실시간으로 처리하고, Socket과 Linux 기반의 서버-클라이언트 구조로 데이터를 송수신하며 하드웨어 제어를 통해 분류 작업을 자동화합니다.

### 프로젝트 기간  
2023. 08. ~ 2024. 05.

### 인원 (역할)  
3인 (이미지/영상 처리 및 모델 학습, 하드웨어 프로그램 설계)

### 사용 기술  
- **YOLOv5**, **OpenCV**, **PyTorch**  
- **Socket**, **Linux**

---

## 🛠 주요 역할 및 기능

### YOLOv5를 이용한 사과 상태 판별  
- 7,434장의 정상 및 불량 사과 이미지 수집, 전처리 및 라벨링  
- YOLOv5s 모델을 사용하여 하이퍼파라미터 최적화 및 모델 학습  
- 자상, 압상, 병충해 등을 인식하여 불량 또는 정상으로 처리

### 실시간 캡처 및 저장  
- OpenCV를 활용해 실시간 비디오 스트림 캡처 및 사용자에게 영상 제공  
- 사과 감지 시 이미지를 캡처하여 로컬 폴더 내에 저장, 폴더를 1초마다 확인하고 새로운 JPG 파일을 감지하여 Firebase Storage로 업로드  
- Socket 통신을 이용한 서버와 클라이언트 간 실시간 데이터 송수신 처리

### 분류 시스템 제어  
- 분류 시스템의 하드웨어 설계 및 임베디드 시스템 개발  
- 컨베이어 벨트(DC 모터, 서보 모터, 초음파 센서로 구성)의 동작을 제어하여 정상/불량 판별 결과에 따라 과일을 분류

---

## ⚙️ 트러블 슈팅

### 정상과 불량 판별 오류  
- **문제점**: 정상 사과를 불량으로 잘못 판별하는 현상 발생  
- **원인**: 모델이 특정 조명 조건이나 각도에서 정상 사과를 불량으로 잘못 판별  
- **해결 방법**: 데이터셋에 다양한 조명 조건과 각도의 이미지를 추가하여 모델의 일반화 능력 향상 및 추가적인 데이터 증강 기법을 적용하여 판별 정확도 개선

### 영상 전송 시의 프레임 딜레이  
- **문제점**: 영상 처리 시, 프레임 딜레이가 20초 이상으로 길게 나타나는 문제 발생  
- **원인**: 라즈베리파이가 영상 분석 및 분류 시스템 제어를 동시에 처리하면서 과부하 발생  
- **해결 방법**: Socket 모듈을 이용해 영상 분석과 분류 시스템 제어를 클라이언트와 서버로 분리하여 프레임 딜레이를 20초 이상에서 5초 이내로 줄임

---

## 🔧 Stack  
**Language**  
- Python  

**Libraries & Frameworks**  
- YOLOv5, OpenCV, PyTorch  

**Tools & Communication**  
- Socket, Firebase, Linux  

**Hardware**  
- Raspberry Pi, DC 모터, 서보 모터, 초음파 센서  

---

## 🙋‍♂️ Developer  
| Fullstack |  
| :--------: |  
| [김가은](https://github.com/gaeunamy) |
